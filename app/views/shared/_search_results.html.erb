
  <% if results.any? %>
    <%# AI Response Section %>
    <% if ai_response.present? %>
      <%= content_tag :div, class: 'bg-gradient-to-r from-emerald-50 to-teal-50 border-b border-emerald-100 p-4' do %>
        <%= content_tag :div, class: 'flex items-start gap-3' do %>
          <%= content_tag :div, class: 'flex-shrink-0 mt-1' do %>
            <%= heroicon 'sparkles', options: { class: 'size-5 text-emerald-600' } %>
          <% end %>
          <%= content_tag :div, class: 'flex-1' do %>
            <%= content_tag :p, class: 'text-xs font-semibold text-emerald-700 uppercase tracking-wide mb-1' do %>
              AI Summary
            <% end %>
            <%= content_tag :p, class: 'text-sm text-gray-800 leading-relaxed' do %>
              <%= ai_response %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>

    <%# Results Header %>
    <%= content_tag :div, class: 'px-4 py-3 bg-gray-50 border-b border-gray-200' do %>
      <%= content_tag :div, class: 'flex items-center justify-between' do %>
        <%= content_tag :p, class: 'text-sm font-medium text-gray-700' do %>
          <%= "#{results.count} #{'result'.pluralize(results.count)} from #{total_documents} #{'document'.pluralize(total_documents)}" %>
        <% end %>
        <%= content_tag :p, class: 'text-xs text-gray-500' do %>
          <%= "Query: \"#{query}\"" %>
        <% end %>
      <% end %>
    <% end %>

    <%# Results List %>
    <%= content_tag :div, class: 'overflow-y-auto max-h-96' do %>
      <% results.each do |result| %>
        <%= link_to collection_document_path(result[:document].collection, result[:document]),
          class: 'block px-4 py-4 hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-0',
          data: { turbo_frame: '_top' } do %>
          
          <%= content_tag :div, class: 'flex items-start justify-between gap-3' do %>
            <%= content_tag :div, class: 'flex-1 min-w-0' do %>
              <%# Document Title %>
              <%= content_tag :div, class: 'flex items-center gap-2 mb-1' do %>
                <%= heroicon 'document-text', options: { class: 'size-4 text-gray-400 flex-shrink-0' } %>
                <%= content_tag :h3, class: 'font-semibold text-gray-900 truncate' do %>
                  <%= result[:document].title %>
                <% end %>
              <% end %>

              <%# Chunk Content %>
              <%= content_tag :p, class: 'text-sm text-gray-600 line-clamp-2 mb-2' do %>
                <%= truncate(result[:content], length: 200, separator: ' ') %>
              <% end %>

              <%# Content Summary if available %>
              <% if result[:summary].present? %>
                <%= content_tag :p, class: 'text-xs text-gray-500 italic mb-2' do %>
                  <%= truncate(result[:summary], length: 150, separator: ' ') %>
                <% end %>
              <% end %>

              <%# Metadata %>
              <%= content_tag :div, class: 'flex items-center gap-3 text-xs text-gray-500' do %>
                <% if result[:document].collection.present? %>
                  <%= content_tag :span, class: 'flex items-center gap-1' do %>
                    <%= heroicon 'folder', options: { class: 'size-3' } %>
                    <%= result[:document].collection.title %>
                  <% end %>
                <% end %>
                <%= content_tag :span do %>
                  <%= time_ago_in_words(result[:document].created_at) %> ago
                <% end %>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% else %>
    <%# No Results State %>
    <%= content_tag :div, class: 'px-4 py-12 text-center' do %>
      <%= content_tag :div, class: 'inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-full mb-4' do %>
        <%= heroicon 'magnifying-glass', options: { class: 'size-8 text-gray-400' } %>
      <% end %>
      <%= content_tag :h3, class: 'text-lg font-medium text-gray-900 mb-2' do %>
        No results found
      <% end %>
      <%= content_tag :p, class: 'text-sm text-gray-500 max-w-sm mx-auto' do %>
        We couldn't find any documents matching "<%= query %>". Try adjusting your search terms or check your document collection.
      <% end %>
    <% end %>
  <% end %>
